<html>
	<head>
		<title>bike share graph test</title>
		<script src="http://mbostock.github.com/d3/d3.v2.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
		<style>
			/* tell the SVG path to be a thin blue line without any area fill */
			.labelbox {
				opacity: 0.7;
				fill: #fff;
			}

			.outflow {
				stroke: steelblue;
				stroke-width: 1;
				fill: none;
			}

			.outflowtext {
				font-family: sans-serif;
				font-size: 10px;
				fill: steelblue;
			}

			.emptytext {
				font-family: sans-serif;
				font-size: 10px;
				fill: lightcoral;
			}

			.empty {
				stroke: lightcoral;
				stroke-width: 1;
				fill: none;
			}

			path.score {
				stroke: crimson;
				stroke-width: 1;
				fill: none;
			}

			.axis {
			  shape-rendering: crispEdges;
			}

			.axis text {
				font-family: sans-serif;
				font-size: 10px;
			}
 
			.x.axis line {
			  stroke: lightgrey;
			}
 
			.x.axis path {
			  fill: none;
			  stroke: #fff;
			  stroke-width: 1px;
			}
 
			.y.axis line, .y.axis path {
				stroke: #eee;
				stroke-width: 0.5px;
				fill: none;
			}

			.y1.axis text {
				fill: steelblue;
			}
			.y2.axis text {
				fill: lightcoral;
			}
			.y3.axis text {
				fill: #666;
			}
		</style>
	</head>
	<body>
 
 
	<div id="graph"></div>
	<div id="graph2"></div>
	<div id="graph3"></div>
	<div id="graph4"></div>
 
 
	<script>
// define dimensions of graph
var m = [80, 80, 80, 80]; // margins
var w = 400 - m[1] - m[3]; // width
var h = 300 - m[0] - m[2]; // height
var x, y;

// inputs: station id and variable to graph.
var stationid = '69';
var data;


// Add an SVG element with the desired dimensions and margin.
var graph = d3.select("#graph").append("svg:svg")
      .attr("width", w + m[1] + m[3])
      .attr("height", h + m[0] + m[2])
    .append("svg:g")
      .attr("transform", "translate(" + m[3] + "," + m[0] + ")");

// testing with second graph
var graph2 = d3.select("#graph2").append("svg:svg")
      .attr("width", w + m[1] + m[3])
      .attr("height", h + m[0] + m[2])
    .append("svg:g")
      .attr("transform", "translate(" + m[3] + "," + m[0] + ")");

// testing with third graph, just show the frustration score
var graph3 = d3.select("#graph3").append("svg:svg")
      .attr("width", w + m[1] + m[3])
      .attr("height", h + m[0] + m[2])
    .append("svg:g")
      .attr("transform", "translate(" + m[3] + "," + m[0] + ")");

// testing with another frustration score graph
var graph4 = d3.select("#graph4").append("svg:svg")
      .attr("width", w + m[1] + m[3])
      .attr("height", h + m[0] + m[2])
    .append("svg:g")
      .attr("transform", "translate(" + m[3] + "," + m[0] + ")");


var stationlist = [{'region': 'San Jose', 'long': '-121.901782', 'installation_date': '8/6/2013', 'station_id': '2', 'lat': '37.329732', 'station_name': 'San Jose Diridon Caltrain Station', 'dockcount': '27'}, {'region': 'San Jose', 'long': '-121.888979', 'installation_date': '8/5/2013', 'station_id': '3', 'lat': '37.330698', 'station_name': 'San Jose Civic Center', 'dockcount': '15'}, {'region': 'San Jose', 'long': '-121.894902', 'installation_date': '8/6/2013', 'station_id': '4', 'lat': '37.333988', 'station_name': 'Santa Clara at Almaden', 'dockcount': '11'}, {'region': 'San Jose', 'long': '-121.8932', 'installation_date': '8/5/2013', 'station_id': '5', 'lat': '37.331415', 'station_name': 'Adobe on Almaden', 'dockcount': '19'}, {'region': 'San Jose', 'long': '-121.894074', 'installation_date': '8/7/2013', 'station_id': '6', 'lat': '37.336721', 'station_name': 'San Pedro Square', 'dockcount': '15'}, {'region': 'San Jose', 'long': '-121.886943', 'installation_date': '8/7/2013', 'station_id': '7', 'lat': '37.333798', 'station_name': 'Paseo de San Antonio', 'dockcount': '15'}, {'region': 'San Jose', 'long': '-121.885831', 'installation_date': '8/5/2013', 'station_id': '8', 'lat': '37.330165', 'station_name': 'San Salvador at 1st', 'dockcount': '15'}, {'region': 'San Jose', 'long': '-121.894715', 'installation_date': '8/5/2013', 'station_id': '9', 'lat': '37.348742', 'station_name': 'Japantown', 'dockcount': '15'}, {'region': 'San Jose', 'long': '-121.886995', 'installation_date': '8/6/2013', 'station_id': '10', 'lat': '37.337391', 'station_name': 'San Jose City Hall', 'dockcount': '15'}, {'region': 'San Jose', 'long': '-121.88566', 'installation_date': '8/6/2013', 'station_id': '11', 'lat': '37.335885', 'station_name': 'MLK Library', 'dockcount': '19'}, {'region': 'San Jose', 'long': '-121.883891', 'installation_date': '8/7/2013', 'station_id': '12', 'lat': '37.332808', 'station_name': 'SJSU 4th at San Carlos', 'dockcount': '19'}, {'region': 'San Jose', 'long': '-121.889937', 'installation_date': '8/6/2013', 'station_id': '13', 'lat': '37.339301', 'station_name': 'St James Park', 'dockcount': '15'}, {'region': 'San Jose', 'long': '-121.900084', 'installation_date': '8/5/2013', 'station_id': '14', 'lat': '37.332692', 'station_name': 'Arena Green / SAP Center', 'dockcount': '19'}, {'region': 'San Jose', 'long': '-121.877349', 'installation_date': '8/7/2013', 'station_id': '16', 'lat': '37.333955', 'station_name': 'SJSU - San Salvador at 9th', 'dockcount': '15'}, {'region': 'Redwood City', 'long': '-122.226904', 'installation_date': '8/12/2013', 'station_id': '21', 'lat': '37.481758', 'station_name': 'Franklin at Maple', 'dockcount': '15'}, {'region': 'Redwood City', 'long': '-122.232089', 'installation_date': '8/15/2013', 'station_id': '22', 'lat': '37.486078', 'station_name': 'Redwood City Caltrain Station', 'dockcount': '25'}, {'region': 'Redwood City', 'long': '-122.231061', 'installation_date': '8/15/2013', 'station_id': '23', 'lat': '37.488501', 'station_name': 'San Mateo County Center', 'dockcount': '15'}, {'region': 'Redwood City', 'long': '-122.227424', 'installation_date': '8/12/2013', 'station_id': '24', 'lat': '37.484219', 'station_name': 'Redwood City Public Library', 'dockcount': '15'}, {'region': 'Redwood City', 'long': '-122.225551', 'installation_date': '8/12/2013', 'station_id': '25', 'lat': '37.486725', 'station_name': 'Broadway at Main', 'dockcount': '15'}, {'region': 'Redwood City', 'long': '-122.223492', 'installation_date': '8/12/2013', 'station_id': '26', 'lat': '37.487682', 'station_name': 'Redwood City Medical Center', 'dockcount': '15'}, {'region': 'Mountain View', 'long': '-122.081896', 'installation_date': '8/16/2013', 'station_id': '27', 'lat': '37.389218', 'station_name': 'Mountain View City Hall', 'dockcount': '15'}, {'region': 'Mountain View', 'long': '-122.076713', 'installation_date': '8/15/2013', 'station_id': '28', 'lat': '37.394358', 'station_name': 'Mountain View Caltrain Station', 'dockcount': '23'}, {'region': 'Mountain View', 'long': '-122.106758', 'installation_date': '8/15/2013', 'station_id': '29', 'lat': '37.40694', 'station_name': 'San Antonio Caltrain Station', 'dockcount': '23'}, {'region': 'Mountain View', 'long': '-122.066553', 'installation_date': '8/16/2013', 'station_id': '30', 'lat': '37.390277', 'station_name': 'Evelyn Park and Ride', 'dockcount': '15'}, {'region': 'Mountain View', 'long': '-122.108338', 'installation_date': '12/31/2013', 'station_id': '31', 'lat': '37.400443', 'station_name': 'San Antonio Shopping Center', 'dockcount': '15'}, {'region': 'Mountain View', 'long': '-122.083678', 'installation_date': '12/31/2013', 'station_id': '32', 'lat': '37.385956', 'station_name': 'Castro Street and El Camino Real', 'dockcount': '11'}, {'region': 'Mountain View', 'long': '-122.099076', 'installation_date': '8/16/2013', 'station_id': '33', 'lat': '37.400241', 'station_name': 'Rengstorff Avenue / California Street', 'dockcount': '15'}, {'region': 'Palo Alto', 'long': '-122.164759', 'installation_date': '8/14/2013', 'station_id': '34', 'lat': '37.443988', 'station_name': 'Palo Alto Caltrain Station', 'dockcount': '23'}, {'region': 'Palo Alto', 'long': '-122.163093', 'installation_date': '8/15/2013', 'station_id': '35', 'lat': '37.444521', 'station_name': 'University and Emerson', 'dockcount': '11'}, {'region': 'Palo Alto', 'long': '-122.142805', 'installation_date': '8/14/2013', 'station_id': '36', 'lat': '37.429082', 'station_name': 'California Ave Caltrain Station', 'dockcount': '15'}, {'region': 'Palo Alto', 'long': '-122.159504', 'installation_date': '8/14/2013', 'station_id': '37', 'lat': '37.448598', 'station_name': 'Cowper at University', 'dockcount': '11'}, {'region': 'Palo Alto', 'long': '-122.137778', 'installation_date': '8/14/2013', 'station_id': '38', 'lat': '37.425684', 'station_name': 'Park at Olive', 'dockcount': '15'}, {'region': 'San Francisco', 'long': '-122.39997', 'installation_date': '8/19/2013', 'station_id': '41', 'lat': '37.795001', 'station_name': 'Clay at Battery', 'dockcount': '15'}, {'region': 'San Francisco', 'long': '-122.398436', 'installation_date': '8/19/2013', 'station_id': '42', 'lat': '37.79728', 'station_name': 'Davis at Jackson', 'dockcount': '15'}, {'region': 'San Francisco', 'long': '-122.402923', 'installation_date': '8/19/2013', 'station_id': '45', 'lat': '37.794231', 'station_name': 'Commercial at Montgomery', 'dockcount': '15'}, {'region': 'San Francisco', 'long': '-122.404767', 'installation_date': '8/19/2013', 'station_id': '46', 'lat': '37.795425', 'station_name': 'Washington at Kearney', 'dockcount': '15'}, {'region': 'San Francisco', 'long': '-122.403452', 'installation_date': '8/19/2013', 'station_id': '47', 'lat': '37.788975', 'station_name': 'Post at Kearney', 'dockcount': '19'}, {'region': 'San Francisco', 'long': '-122.398525', 'installation_date': '8/19/2013', 'station_id': '48', 'lat': '37.799953', 'station_name': 'Embarcadero at Vallejo', 'dockcount': '15'}, {'region': 'San Francisco', 'long': '-122.390264', 'installation_date': '8/20/2013', 'station_id': '49', 'lat': '37.789625', 'station_name': 'Spear at Folsom', 'dockcount': '19'}, {'region': 'San Francisco', 'long': '-122.394203', 'installation_date': '8/20/2013', 'station_id': '50', 'lat': '37.795392', 'station_name': 'Harry Bridges Plaza (Ferry Building)', 'dockcount': '23'}, {'region': 'San Francisco', 'long': '-122.391034', 'installation_date': '8/20/2013', 'station_id': '51', 'lat': '37.791464', 'station_name': 'Embarcadero at Folsom', 'dockcount': '19'}, {'region': 'San Francisco', 'long': '-122.408433', 'installation_date': '8/25/2013', 'station_id': '53', 'lat': '37.783871', 'station_name': 'Powell Street BART', 'dockcount': '19'}, {'region': 'San Francisco', 'long': '-122.388013', 'installation_date': '8/20/2013', 'station_id': '54', 'lat': '37.787152', 'station_name': 'Embarcadero at Bryant', 'dockcount': '15'}, {'region': 'San Francisco', 'long': '-122.394643', 'installation_date': '8/20/2013', 'station_id': '55', 'lat': '37.789756', 'station_name': 'Temporary Transbay Terminal (Howard at Beale)', 'dockcount': '23'}, {'region': 'San Francisco', 'long': '-122.397086', 'installation_date': '8/20/2013', 'station_id': '56', 'lat': '37.792251', 'station_name': 'Beale at Market', 'dockcount': '19'}, {'region': 'San Francisco', 'long': '-122.405127', 'installation_date': '8/21/2013', 'station_id': '57', 'lat': '37.781752', 'station_name': '5th at Howard', 'dockcount': '15'}, {'region': 'San Francisco', 'long': '-122.418235', 'installation_date': '8/21/2013', 'station_id': '58', 'lat': '37.77865', 'station_name': 'San Francisco City Hall', 'dockcount': '19'}, {'region': 'San Francisco', 'long': '-122.418603', 'installation_date': '8/21/2013', 'station_id': '59', 'lat': '37.781332', 'station_name': 'Golden Gate at Polk', 'dockcount': '23'}, {'region': 'San Francisco', 'long': '-122.403234', 'installation_date': '8/21/2013', 'station_id': '60', 'lat': '37.80477', 'station_name': 'Embarcadero at Sansome', 'dockcount': '15'}, {'region': 'San Francisco', 'long': '-122.390288', 'installation_date': '8/22/2013', 'station_id': '61', 'lat': '37.780526', 'station_name': '2nd at Townsend', 'dockcount': '27'}, {'region': 'San Francisco', 'long': '-122.396236', 'installation_date': '8/22/2013', 'station_id': '62', 'lat': '37.785299', 'station_name': '2nd at Folsom', 'dockcount': '19'}, {'region': 'San Francisco', 'long': '-122.398108', 'installation_date': '8/22/2013', 'station_id': '63', 'lat': '37.786978', 'station_name': 'Howard at 2nd', 'dockcount': '19'}, {'region': 'San Francisco', 'long': '-122.392738', 'installation_date': '8/22/2013', 'station_id': '64', 'lat': '37.782259', 'station_name': '2nd at South Park', 'dockcount': '15'}, {'region': 'San Francisco', 'long': '-122.402717', 'installation_date': '8/22/2013', 'station_id': '65', 'lat': '37.771058', 'station_name': 'Townsend at 7th', 'dockcount': '15'}, {'region': 'San Francisco', 'long': '-122.418954', 'installation_date': '8/23/2013', 'station_id': '66', 'lat': '37.774814', 'station_name': 'South Van Ness at Market', 'dockcount': '19'}, {'region': 'San Francisco', 'long': '-122.417385', 'installation_date': '8/23/2013', 'station_id': '67', 'lat': '37.776619', 'station_name': 'Market at 10th', 'dockcount': '27'}, {'region': 'San Francisco', 'long': '-122.401014', 'installation_date': '8/23/2013', 'station_id': '68', 'lat': '37.784878', 'station_name': 'Yerba Buena Center of the Arts (3rd @ Howard)', 'dockcount': '19'}, {'region': 'San Francisco', 'long': '-122.39607', 'installation_date': '8/23/2013', 'station_id': '69', 'lat': '37.776377', 'station_name': 'San Francisco Caltrain 2 (330 Townsend)', 'dockcount': '23'}, {'region': 'San Francisco', 'long': '-122.395569', 'installation_date': '8/23/2013', 'station_id': '70', 'lat': '37.776317', 'station_name': 'San Francisco Caltrain (Townsend at 4th)', 'dockcount': '19'}, {'region': 'San Francisco', 'long': '-122.408499', 'installation_date': '8/23/2013', 'station_id': '71', 'lat': '37.788446', 'station_name': 'Powell at Post (Union Square)', 'dockcount': '19'}, {'region': 'San Francisco', 'long': '-122.412919', 'installation_date': '8/23/2013', 'station_id': '72', 'lat': '37.780356', 'station_name': 'Civic Center BART (7th at Market)', 'dockcount': '23'}, {'region': 'San Francisco', 'long': '-122.407245', 'installation_date': '8/21/2013', 'station_id': '73', 'lat': '37.798522', 'station_name': 'Grant Avenue at Columbus Avenue', 'dockcount': '15'}, {'region': 'San Francisco', 'long': '-122.394434', 'installation_date': '8/25/2013', 'station_id': '74', 'lat': '37.794139', 'station_name': 'Steuart at Market', 'dockcount': '23'}, {'region': 'San Francisco', 'long': '-122.399051', 'installation_date': '8/25/2013', 'station_id': '75', 'lat': '37.7913', 'station_name': 'Mechanics Plaza (Market at Battery)', 'dockcount': '19'}, {'region': 'San Francisco', 'long': '-122.404966', 'installation_date': '8/25/2013', 'station_id': '76', 'lat': '37.786305', 'station_name': 'Market at 4th', 'dockcount': '19'}, {'region': 'San Francisco', 'long': '-122.400811', 'installation_date': '8/25/2013', 'station_id': '77', 'lat': '37.789625', 'station_name': 'Market at Sansome', 'dockcount': '27'}, {'region': 'San Jose', 'long': '-121.905733', 'installation_date': '12/31/2013', 'station_id': '80', 'lat': '37.352601', 'station_name': 'San Jose Government Center', 'dockcount': '15'}, {'region': 'San Francisco', 'long': '-122.400862', 'installation_date': '1/22/2014', 'station_id': '82', 'lat': '37.798541', 'station_name': 'Broadway St at Battery St', 'dockcount': '15'}, {'region': 'Redwood City', 'long': '-122.236234', 'installation_date': '2/20/2014', 'station_id': '83', 'lat': '37.491269', 'station_name': 'Mezes Park', 'dockcount': '15'}]


$.getJSON('array_scores.json',function(d) {
	data = d;

	drawGraph(graph, 69);
	drawGraph(graph2, 77);

	drawSingleGraph(graph3, 69);
	drawSingleGraph(graph4, 77);


	$('#submit').click(function() {
		stationid = $('#text').val();

		redrawGraph(graph2, stationid);
		redrawSingle(graph3, stationid);
	});


});

function drawGraph(graph, stationid) {
	var stationindex;

	// get array index for station
	for(var i = 0 ; i < data[0].stations.length ; ++i) {
		if(data[0].stations[i].station_id == stationid) {
			stationindex = i;
		}
	}

	// get max outflow and empty, for scale
	var maxoutflow = 0;
	var maxempty = 0;
	for(var i = 0 ; i < data.length; ++i) {
		if(data[i].stations[stationindex].tot_outflow > maxoutflow)
			maxoutflow = data[i].stations[stationindex].tot_outflow;
		if(data[i].stations[stationindex].tot_empty_duration > maxempty)
			maxempty = data[i].stations[stationindex].tot_empty_duration;
	}

	x = d3.scale.linear().domain([0, data.length]).range([0, w]);
	y1 = d3.scale.linear().domain([0, maxoutflow]).range([h, 0]);
	y2 = d3.scale.linear().domain([0, maxempty]).range([h, 0]);

	// create a line function that can convert data[] into x and y points
	var line = d3.svg.line()
		.x(function(d,i) { 
			return x(i); 
		})
		.y(function(d) { 
			return y1(d.stations[stationindex].tot_outflow); 
		})

	var emptyline = d3.svg.line()
		.x(function(d,i) { 
			return x(i); 
		})
		.y(function(d) { 
			return y2(d.stations[stationindex].tot_empty_duration); 
		})

	// axes
	var xAxis = d3.svg.axis().scale(x).ticks(0).tickSize(0,0);
	graph.append("svg:g")
	      .attr("class", "x axis")
	      .attr("transform", "translate(0," + h + ")")
	      .call(xAxis);


	var yAxisLeft = d3.svg.axis().scale(y1).ticks(3).tickSize(0,0).orient("left");
	graph.append("svg:g")
	      .attr("class", "y y1 axis")
	      .attr("transform", "translate(0,0)")
	      .call(yAxisLeft);

	var yAxisRight = d3.svg.axis().scale(y2).ticks(3).tickSize(0,0).orient("right");
	graph.append("svg:g")
	      .attr("class", "y y2 axis")
	      .attr("transform", "translate(" + w + ",0)")
	      .call(yAxisRight);

	// lines on top of axes
	var linepath = graph.append("svg:path").attr("d", line(data)).attr("class", "outflow");
	var linepath = graph.append("svg:path").attr("d", emptyline(data)).attr("class", "empty");

	// labels
	graph.append('rect')
		.attr('x', w-78)
		.attr('y', 5)
		.attr('width', 68)
		.attr('height', 35)
		.attr('class', 'labelbox');

	graph.append('svg:line')
		.attr('x1', w-70)
		.attr('y1', 15)
		.attr('x2', w-55)
		.attr('y2', 15)
		.attr('class', 'outflow');
	graph.append('svg:line')
		.attr('x1', w-70)
		.attr('y1', 30)
		.attr('x2', w-55)
		.attr('y2', 30)
		.attr('class', 'empty');

	graph.append('svg:text')
		.attr('x', w-50)
		.attr('y', 15)
		.attr('alignment-baseline', 'middle')
		.text('outflow')
		.attr('class', 'outflowtext');
	graph.append('svg:text')
		.attr('x', w-50)
		.attr('y', 30)
		.attr('alignment-baseline', 'middle')
		.text('empty')
		.attr('class', 'emptytext');

}


// draw single graph for score
function drawSingleGraph(graph, stationid) {
	var stationindex;

	// get array index for station
	for(var i = 0 ; i < data[0].stations.length ; ++i) {
		if(data[0].stations[i].station_id == stationid) {
			// found it
			stationindex = i;
		}
	}

	// get max score
	var maxscore = 0;
	for(var i = 0 ; i < data.length; ++i) {
		if(data[i].stations[stationindex].score > maxscore)
			maxscore = data[i].stations[stationindex].score;
	}

	x = d3.scale.linear().domain([0, data.length]).range([0, w]);
	y = d3.scale.linear().domain([0, maxscore]).range([h, 0]);

	// create a line function that can convert data[] into x and y points
	var line = d3.svg.line()
		.x(function(d,i) { 
			return x(i); 
		})
		.y(function(d) { 
			return y(d.stations[stationindex].score); 
		})

	var xAxis = d3.svg.axis().scale(x).ticks(0).tickSize(0,0);
	graph.append("svg:g")
	      .attr("class", "x axis")
	      .attr("transform", "translate(0," + h + ")")
	      .call(xAxis);


	var yAxisLeft = d3.svg.axis().scale(y).ticks(3).tickSize(0,0).orient("left");
	graph.append("svg:g")
	      .attr("class", "y y3 axis")
	      .attr("transform", "translate(0,0)")
	      .call(yAxisLeft);

	var linepath = graph.append("svg:path").attr("d", line(data)).attr("class", "score");
}

// draw single graph for score
function redrawSingle(graph, stationid) {
	var stationindex;

	// get array index for station
	for(var i = 0 ; i < data[0].stations.length ; ++i) {
		if(data[0].stations[i].station_id == stationid) {
			// found it
			stationindex = i;
		}
	}

	// get max score
	var maxscore = 0;
	for(var i = 0 ; i < data.length; ++i) {
		if(data[i].stations[stationindex].score > maxscore)
			maxscore = data[i].stations[stationindex].score;
	}

	x = d3.scale.linear().domain([0, data.length]).range([0, w]);
	y = d3.scale.linear().domain([0, maxscore]).range([h, 0]);

	// create a line function that can convert data[] into x and y points
	var line = d3.svg.line()
		.x(function(d,i) { 
			return x(i); 
		})
		.y(function(d) { 
			return y(d.stations[stationindex].score); 
		})

	var linepath = graph.select("path.score").transition().attr("d", line(data));
	var yAxisLeft = d3.svg.axis().scale(y).ticks(3).tickSize(0,0).orient("left");
	graph.select(".y3").transition().call(yAxisLeft);


}


function redrawGraph(graph, stationid) {
	var stationname;

	// get index
	for(var i = 0 ; i < data[0].stations.length ; ++i) {
		if(data[0].stations[i].station_id == stationid) {
			// found it
			stationindex = i;
			stationname = stationlist[i].station_name;
		}
	}


	// get max outflow and empty, for scale
	var maxoutflow = 0;
	var maxempty = 0;
	for(var i = 0 ; i < data.length; ++i) {
		if(data[i].stations[stationindex].tot_outflow > maxoutflow)
			maxoutflow = data[i].stations[stationindex].tot_outflow;
		if(data[i].stations[stationindex].tot_empty_duration > maxempty)
			maxempty = data[i].stations[stationindex].tot_empty_duration;
	}


	x = d3.scale.linear().domain([0, data.length]).range([0, w]);
	y1 = d3.scale.linear().domain([0, maxoutflow]).range([h, 0]);
	y2 = d3.scale.linear().domain([0, maxempty]).range([h, 0]);


	var line = d3.svg.line()
		.x(function(d,i) { 
			return x(i); 
		})
		.y(function(d) { 
			return y1(d.stations[stationindex].tot_outflow); 
		})

	var emptyline = d3.svg.line()
		.x(function(d,i) { 
			return x(i); 
		})
		.y(function(d) { 
			return y2(d.stations[stationindex].tot_empty_duration); 
		})


	// get the path and transition
	var linepath = graph.select("path.outflow").transition().attr("d", line(data));
	var emptypath = graph.select("path.empty").transition().attr("d", emptyline(data));

	var yAxisLeft = d3.svg.axis().scale(y1).ticks(3).tickSize(0,0).orient("left");
	var yAxisRight = d3.svg.axis().scale(y2).ticks(3).tickSize(0,0).orient("right");
	graph.select(".y1").transition().call(yAxisLeft);
	graph.select(".y2").transition().call(yAxisRight);

	$('#stationname').text(stationname);
}


$(document).ready(function() {
	var stationname;
	// get array index for station
	for(var i = 0 ; i < stationlist.length ; ++i) {
		if(stationlist[i].station_id == stationid) {
			// found it
			stationname = stationlist[i].station_name;
		}
	}

	$('#stationname').text(stationname);
});

	</script>
 

Currently showing total outflows. Select station ID: <input id="text" type="text"> <input id="submit" type="submit">
 <p id="stationname"></p>
	</body>
</html>
